<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>	
  <!-- This site is based on the Auguste template designed and coded [Gian Carlo Franco](www.carlofranco.ca). Antique variation by Brett Terpstra. -->
	<title>Safari Reader Antique hack</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="readability-verification" content="rbPZmz5uZnPmEg4UNerszNZUcyxN2aHQL7XcRewB">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
  <link rel='me' href='http://www.google.com/profiles/circlesixdesign' />
	<meta name="robots" content="all" />
	<meta name="robots" content="index, follow" />
	<meta name="revisit-after" content="7 days" />
	<meta name="version" content="1.0" />
	<meta name="copyright" content="" />
	<link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico" />
	<link rel="apple-touch-icon" href="/favicon.png"/>
	<link rel="alternate" type="application/atom+xml" title="brettterpstra.dev RSS Feed" href="/feed.xml" />
	<!-- CSS -->
	<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"/>
	<link rel="stylesheet" href="/css/monokai.css" media="screen" type="text/css"/>
	<!-- <link rel="stylesheet" href="/css/screen.min.css" media="screen" type="text/css"/> -->
	<!--[if IE 6]>
	<link href="/css/ie.css" rel="stylesheet" media="screen" type="text/css" />
	<![endif]-->
</head>
<body class="blog single-post">
	<div id="header-wrapper">
		<div id="header">
			<h1>
				<a id="logo" href="/" title="Brett Terpstra">Brett Terpstra</a>
			</h1>
			<div id="nav">
	<ul>
		<li><a class="current home" href="/">Home</a></li>
		<li><a href="/categories/">Categories</a></li>
		<li><a href="/tags/">Tags</a></li>
		<li><a href="/contact/">Contact</a></li>
    <!-- <li><a href="#">Projects</a></li> -->
		<li><a href="/about/">About</a></li>
	</ul>
</div><!-- end: #nav -->
		</div><!-- end: #header -->
	</div><!-- end: #header-wrapper-->
	<div id="content-wrapper">
		<div id="main-container" class="clearfix">
			<div id="content">
	<div class="post">
		<div class="post-meta">
			<span class="date">12 Jun 2010 | </span>
			<span class="num-comments"><a href="#comments"><span class="responses-number">0</span> Comments</a> | </span>
			<span class="categories">
				Category: <a href="/categories/code">Code</a>
			</span>
		</div>
		<h1 class="post-title"><a href="#">Safari Reader Antique hack</a></h1>
		<p><a href="http://brettterpstra.dev/wp-content/uploads/2010/06/SafariReaderNewFullFrame_1024.jpg"><img src="http://brettterpstra.dev/wp-content/uploads/2010/06/SafariReaderNewFullFrame_1024-300x219.jpg" alt="Safari Reader Antique hack" title="Safari Reader Antique hack" width="300" height="219" class="alignright size-medium wp-image-565" /></a></p>

<p><strong>There is a new version of Antique available! <a href="http://brettterpstra.dev/2010/06/17/antique-1-6-final-release/">Check out version 1.6</a>!</strong></p>

<p>I was thrilled when it was first announced that someone had located the HTML/CSS for the new Safari Reader functionality in Safari 5, which happened the day it was released. I&rsquo;ve been toying around with some ideas in the days since, and this hack is the result of a little too much effort. Click the screenshot thumbnail to see a full version.</p>

<p>It has a few interesting components&hellip;</p>

<!--more-->

<ul>
  <li>Uses CSS3 to find doubleclick.net ads, which Reader sometimes misses because they inject after the DOM loads</li>
  <li>Uses CSS3 to remove blank paragraphs and paragraphs containing nothing but a line break tag</li>
  <li>It only shows the title once, as opposed to at the top of every page</li>
  <li>Many style changes, including:
    <ul>
      <li>uses Google fonts (Crimson Text) </li>
      <li>&ldquo;antique&rdquo; color palette, which extends to the background and HUD</li>
      <li>less-contrasty links, easier to read over but still noticeable</li>
      <li>slight gradient in the background</li>
    </ul>
  </li>
  <li>Extra button in the HUD (Evernote, experimental)</li>
  <li>Narrower scrollbar</li>
  <li>Left-justified text</li>
  <li><del datetime="2010-06-12T10:07:03+00:00">Currently attempting to resize images to max-width 300px (but it&rsquo;s not resizing properly if width/height attributes are set. I&rsquo;ll fix that shortly.)</del></li>
  <li><ins datetime="2010-06-12T10:07:03+00:00"><strong>Update:</strong> using a little Javascript now to resize the images proportionally after page load.</ins></li>
  <li>Adds dashed line indicating page breaks, lightens and shrinks page numbers</li>
  <li><strong>Update:</strong> added a background image. Let me know what you think.
    <ul>
      <li><strong>Update to update:</strong> there&rsquo;s a second download link without the background image.</li>
    </ul>
  </li>
</ul>

<p><a href="http://brettterpstra.dev/wp-content/uploads/2010/06/SafariNewFullFramePageBreak.jpg"><img src="http://brettterpstra.dev/wp-content/uploads/2010/06/SafariNewFullFramePageBreak-300x70.jpg" alt="Safari Reader Antique hack page break closeup" title="Safari Reader Antique hack page break closeup" width="300" height="70" class="size-medium wp-image-563" /></a></p>

<p>If you want to try out the style, &lt;a href=&rdquo;[download id=&rdquo;10&rdquo; format=&rdquo;2&rdquo;]&rdquo;&gt;download it here&lt;/a&gt; (with background image), or grab the &lt;a href=&rdquo;[download id=&rdquo;12&rdquo; format=&rdquo;2&rdquo;]&rdquo;&gt;version with no background image&lt;/a&gt;, and open the archive. Inside you&rsquo;ll find a file called Reader.html. The file you&rsquo;re going to replace (back it up somewhere safe first) is <code>/Applications/Safari.app/Contents/Resources/Reader.html</code>. If you don&rsquo;t know how to do this from Terminal, you can just do it in Finder: go to your Applications folder and locate Safari, then right click on it and choose &ldquo;Show Package Contents.&rdquo; That will open a new window with the inner workings of Safari inside it. Open the folder called Contents, and then the Resources folder inside of that. Locate the file Reader.html and drag it out to your desktop (that&rsquo;s your original, keep it safe). Then drag the new Reader.html file you downloaded into the Resources folder. Restart Safari and try it out!</p>

<p>Some gory details about the process follow&hellip;</p>

<p><img src="http://brettterpstra.dev/wp-content/uploads/2010/06/SafariReaderNewFullFrameHUD.jpg" alt="Safari Reader Antique hack HUD" title="Safari Reader HUD" width="410" height="119" class="size-full wp-image-566" /></p>

<p>I added a button to the HUD as a proof-of-concept. It doesn&rsquo;t do anything very useful yet, the current one just loads the title and URL in the Evernote web clipper in a new tab/window. It would be far more useful if I could get the in-page web clipper to work, but when Reader loads, &ldquo;Reader.html&rdquo; becomes the current location and title. You can access the original information using the ReaderJS object (<code>ReaderJS.originalURL</code> for example), but Evernote&rsquo;s web clipper doesn&rsquo;t let you pass those in, it wants to find them itself. I played around with loading the entire contents of the Reader-rendered page into an iFrame and calling it from there, but I gave up on that after a while. The default print and email functions have success doing something similar; it&rsquo;s more the Evernote clipper that&rsquo;s dragging me down. Anyway, you can add Javascript right in the Reader.html file and insert a button to call it. It&rsquo;s easy.</p>

<p><strong>Update:</strong> I figured it out. I had to dupe Evernote&rsquo;s injected javascript, edit it to use the ReaderJS object that Safari provides for getting the original url and title, then compress and include it in the Reader.html file. It should be fully functional now: pops up the hovering frame and lets you add tags and notes, clips just what Reader is showing using Reader styles (no cleanup necessary in Evernote!) and sends it to your main notebook without opening a new window. If you&rsquo;re not an Evernote user, you can remove the button just by locating it near the bottom of Reader.html in the body portion. It&rsquo;s clearly labeled. You&rsquo;d also want to narrow the HUD back down, so look at the #HUD style and set the width appropriately.</p>

<p>All external images used in the style are base64-encoded and included in the html file, so there are no extra files to mess with. The Google fonts are loaded directly from Google&rsquo;s website, so reading offline would provide a different look, but who reads web pages in Safari when they&rsquo;re offline, really? Using Google&rsquo;s Ajax API&rsquo;s, you can also easily inject jQuery into the mix, <del datetime="2010-06-12T21:15:52+00:00">but I haven&rsquo;t found anything really useful to do with it yet.</del> <ins datetime="2010-06-12T21:15:52+00:00">Actually, I just hacked in <a href="http://colorpowered.com/colorbox/">Colorbox</a> and improved image resizing with some jQuery&hellip; it&rsquo;s definitely going to be in the next release.</ins></p>

<p>So, that&rsquo;s the story. I&rsquo;m sure I&rsquo;ll have completely revamped this by the end of the weekend, but it&rsquo;s at a good place right now. Here&rsquo;s the download link again: &lt;a href=&rdquo;[download id=&rdquo;10&rdquo; format=&rdquo;2&rdquo;]&rdquo;&gt;Antique Style&lt;/a&gt; (and with &lt;a href=&rdquo;[download id=&rdquo;12&rdquo; format=&rdquo;2&rdquo;]&rdquo;&gt;no background image&lt;/a&gt;). Also, I got bored with looking at this style at one point, and decided to make a <a href="http://www.tuaw.com">TUAW</a> style, just for giggles. If you&rsquo;re curious what the whole web would look like through a TUAW lens (<a href="http://brettterpstra.dev/wp-content/uploads/2010/06/TUAWReader.jpg">preview</a>), you can try <a href="http://brettterpstra.dev/downloads/TUAWReader.zip">that one</a> out too. As always, have fun.</p>

<p><strong>There is a new version of Antique available! <a href="http://brettterpstra.dev/2010/06/17/antique-1-6-final-release/">Check out version 1.6</a>!</strong></p>

<p>[download id=&rdquo;10&rdquo;]</p>

<p>[download id=&rdquo;12&rdquo;]</p>

<p><em>Addendum:</em> <del datetime="2010-06-12T21:15:52+00:00">I&rsquo;ve realized it would be entirely possible to add my own HUD with various style selectors and just switch out stylesheets with Javascript. Expect the next Reader hack I release to be a multi-theme bundle of fun.</del> <ins datetime="2010-06-12T21:15:52+00:00">I&rsquo;ve had to scratch this plan for lack of cross-domain local storage for preferences. I can&rsquo;t access the safari.extension API from the Reader.html file, and I can&rsquo;t store a cookie because once Reader loads there&rsquo;s no domain to attach to. If anyone has a good idea that doesn&rsquo;t involve complicated installs, let me know! In the meantime, I&rsquo;m beginning work on a web tool reminiscent of <a href="http://lab.arc90.com/experiments/readability/">Arc90&rsquo;s</a>. It will take your choices of fonts, colors and backgrounds and generate a ready-to-install Reader.html file for you. Not sure how soon I&rsquo;ll get it done, but be sure to <a href="http://twitter.com/ttscoff">follow me on Twitter</a> and/or subscribe to <a href="http://feeds.feedburner.com/BrettTerpstra">the RSS feed</a> for updates.</ins></p>

	</div>
	<div class="nextprev clearfix">
		<a class="prev" href="/antique-safari-reader-hack-update-with-evernote-goodness"><span>Antique Safari Reader hack update with Evernote goodness</span><br/>&larr; Previous Entry</a>
		<a class="next" href="/antique-1-5-for-safari-reader"><span>Antique 1.5 for Safari Reader</span><br/>Next Entry &rarr;</a>
	</div>
	<div class="related-posts section">
		<h3 class="uppercase-title">Related Posts</h3>
		<ol>
			
				<li><a href="/oft-bash-function-for-opening-a-specific-filetype">oft: Bash function for opening a specific filetype</a></li>
			
				<li><a href="/otask-cli-for-omnifocus">OTask: CLI for OmniFocus</a></li>
			
				<li><a href="/web-excursions-june-28-2011-june-30-2011">Web excursions: June 28, 2011 - June 30, 2011</a></li>
			
				<li><a href="/web-excursions-june-15-2011-june-23-2011">Web excursions: June 15, 2011 - June 23, 2011</a></li>
			
				<li><a href="/a-bash-function-for-markdown-bloggers">A Bash function for Markdown bloggers</a></li>
			
		</ol>
	</div><!-- end: related-posts -->
	<div id="comments" class="section">
		<div id="num-responses"><span class="responses-number">0</span> Responses. <a href="#comments">Add Yours!</a></div>
		<h3>Discussion</h3>
		<div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
		<div id="disqus_thread" name="#comments">
		</div>
	</div>
</div><!-- end: #content-->
<div id="sidebar">
	<div id="side-intro" class="section">
	<div id="side-description">
		<p><strong>Brett Terpstra</strong> is Tech Lead for the blogs of AOL Tech. In his free time, he performs mad science with code and shares the results with whoever is curious.</p>
	</div>
	<div id="update-icons">
		<ul>
			<li class="rss"><a href="/feed.xml" title="Grab the Feed">RSS</a></li>
			<li class="twitter"><a class="twitter-anywhere-user" href="http://www.twitter.com/ttscoff">@ttscoff</a></li>
		</ul>
	</div>
</div>
	<div id="side-tabs">
	<ul class="tabnav clearfix">
		<li class="active"><a href="#ui-tabs-1">Recent</a></li>
		<li><a href="#ui-tabs-2">Categories</a></li>
		<li><a href="#ui-tabs-3">Projects</a></li>
	</ul>
	<div id="ui-tabs-1" class="tab-content">
		<ul>
			
				<li><a href="//oft-bash-function-for-opening-a-specific-filetype/" title="oft: Bash function for opening a specific filetype">oft: Bash function for opening a specific filetype</a></li>
			
				<li><a href="//otask-cli-for-omnifocus/" title="OTask: CLI for OmniFocus">OTask: CLI for OmniFocus</a></li>
			
				<li><a href="//web-excursions-june-28-2011-june-30-2011/" title="Web excursions: June 28, 2011 - June 30, 2011">Web excursions: June 28, 2011 - June 30, 2011</a></li>
			
				<li><a href="//web-excursions-june-15-2011-june-23-2011/" title="Web excursions: June 15, 2011 - June 23, 2011">Web excursions: June 15, 2011 - June 23, 2011</a></li>
			
				<li><a href="//a-bash-function-for-markdown-bloggers/" title="A Bash function for Markdown bloggers">A Bash function for Markdown bloggers</a></li>
			
		</ul>
		<a href="/2011/" class="btn-more">more &raquo;</a>
	</div>
	<div id="ui-tabs-2" class="tab-content">
		<ul>
			
				<li><a href="/categories/misc">Misc</a></li>
			
				<li><a href="/categories/blog">Blog</a></li>
			
				<li><a href="/categories/code">Code</a></li>
			
				<li><a href="/categories/bookmarks">Bookmarks</a></li>
			
				<li><a href="/categories/music">Music</a></li>
			
				<li><a href="/categories/write">Write</a></li>
			
		</ul>
		<a href="/categories/" class="btn-more">more &raquo;</a>
	</div>
	
  
  <div id="ui-tabs-3" class="tab-content">
  	<a href="#" class="btn-more">more &raquo;</a>
  	
  	</ul>
  </div>
  
</div>
	<div id="popular-tags" class="section">	
	<h2 class="section-title">Topics</h2>
	<ul>
		
			<li><a href="/tags/safari" name="safari">safari</a></li>
		
			<li><a href="/tags/css" name="css">css</a></li>
		
			<li><a href="/tags/safari-5" name="safari-5">safari 5</a></li>
		
			<li><a href="/tags/reader" name="reader">reader</a></li>
		
			<li><a href="/tags/hacks" name="hacks">hacks</a></li>
		
	</ul>
</div>
</div><!-- end: #sidebar -->
<script type="text/javascript">
    var disqus_shortname = 'brettterpstra';
    var disqus_identifier = '';
    var disqus_url = '/safari-reader-antique-hack';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

		</div><!-- end: #main-container -->
	</div><!-- end: #content-wrapper -->
	<div id="footer-wrapper">
	<div id="footer">
		<div id="colophon">
			<p>Copyright &copy; 2011 Brett Terpstra. All Rights Reserved.</p>
		</div>
	</div><!-- end: #footer -->
</div><!-- end: #footer-wrapper -->
	<!-- Javascript -->
	<script src="/js/jquery.min.js" type="text/javascript"></script>
	<script src="/js/ui.tabs.min.js" type="text/javascript"></script>
	<script src="/js/scripts.js" type="text/javascript"></script>
	
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'brettterpstra'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>
</body>
</html>